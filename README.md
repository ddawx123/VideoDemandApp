# 视频点播WebApp

这段时间随便帮人做的一个视频点播平台（无数据库，完全只是个权限验证+静态网页）

主体没有什么技术含量，只是共享一下其中的一个细节功能

这个细节功能就是使一个账号在同一时间内只能在一处登录，如果在其他设备二次登录，原设备的会话会被自动注销。

具体实现原理：
- 用户首次请求系统，由于没有cookie，将被自动重定向到登陆页
- 用户提供凭据后，系统读取磁盘静态json文件确定凭据合法性，若凭据无效则报出错误原因给用户并返回登陆页
- 登录成功后创建相应cookie，同时系统根据凭据通过内部计算产生唯一的signature，并以该signature为命名创建一个会话记录文件到服务器磁盘
- 会话记录文件内容为当前登录时间的MD5加密值（当然，根据你的业务逻辑，可以进行改动）
- 此时登录过程全部结束，系统将重定向请求到系统主界面
- 系统主界面将做以下几条策略的核验：
  - 是否存在有效的cookie（否则触发拦截器，直接返回登录页）
  - 是否存在会话记录文件（否则触发注销流程清理残留cookie）
  - cookie中的signature字段加密属性和会话记录文件是否匹配（否则提示发现在其他设备登录，并触发注销流程清理残留cookie）
- 此时，通过上述三条二次校验规则，我们实现了简单的同账号互斥登录模式

这里特别说明：本系统仅仅是一套小模型，生产环境建议使用数据库/redis缓存实现会话的登记

更多细节参见源码~

&copy; 2012-2017 DingStudio Technology All Rights Reserved | Author: <a href="https://954759397.qzone.qq.com" target="_blank">alone◎浅忆</a>
